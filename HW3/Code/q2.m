clear all;

x = [-1 -0.5 0 0.5 1];
y = [0 0 1 0 0];
f01 = (y(2)-y(1))/(x(2)-x(1));
f12 = (y(3)-y(2))/(x(3)-x(2));
f23 = (y(4)-y(3))/(x(4)-x(3));
f34 = (y(5)-y(4))/(x(5)-x(4));
h = [0.5 0.5 0.5 0.5];

A = [2*(h(1)+h(2)), h(1), 0; h(2), 2*(h(2)+h(3)), h(3); 0, h(2), 2*(h(3)+h(4))];
B = [f12-f01 f23-f12 f34-f23];
S = linsolve(A, 6.*B');
S = [0; S; 0];

a = [0 0 0 0];
b = [0 0 0 0];s
c = [0 0 0 0];
d = [0 0 0 0];

for i = 1:4
    a(i) = (S(i+1) - S(i))/(6*h(i));
    b(i) = S(i)/2;
    c(i) = (y(i+1)-y(i))/h(i) - (2*h(i)*S(i) + h(i)*S(i+1))/6;
    d(i) = y(i);
end

g0 = @(X) a(1)*(X-x(1)).^3 + b(1)*(X-x(1)).^2 + c(1)*(X-x(1)) + d(1);
g1 = @(X) a(2)*(X-x(2)).^3 + b(2)*(X-x(2)).^2 + c(2)*(X-x(2)) + d(2);
g2 = @(X) a(3)*(X-x(3)).^3 + b(3)*(X-x(3)).^2 + c(3)*(X-x(3)) + d(3);
g3 = @(X) a(4)*(X-x(4)).^3 + b(4)*(X-x(4)).^2 + c(4)*(X-x(4)) + d(4);

hold on;
X0 = linspace(-1, -0.5);
X1 = linspace(-0.5, 0);
X2 = linspace(0, 0.5);
X3 = linspace(0.5, 1);
plot(X0, g0(X0), 'red');
plot(X1, g1(X1), 'red');
plot(X2, g2(X2), 'red');
plot(X3, g3(X3), 'red');
plot(x, y, 'black');



